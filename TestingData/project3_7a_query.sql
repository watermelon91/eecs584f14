SELECT customerid, lastname, numordersFROM (SELECT C.customerid, C.lastname, count(*) as numordersFROM Customers C, Orders OWHERE C.customerid = O.customerid AND C.country = 'Japan' GROUP BY C.customerid, lastname) AS ORDERCOUNTS1WHERE 5 >= (SELECT count(*) FROM (SELECT C.customerid, C.lastname, count(*) as numorders FROM Customers C, Orders OWHERE C.customerid=O.customerid AND C.country = 'Japan' GROUP BY C.customerid, lastname) AS ORDERCOUNTS2WHERE ORDERCOUNTS1.numorders < ORDERCOUNTS2.numorders) ORDER BY customerid;